<!DOCTYPE html>
<html>
<head>
  <title>Discussion Forum</title>
  <style>
    body {
      font-family: sans-serif;
    }
    
    header {
      background-color: #333;
      color: white;
      padding: 10px;
    }
    
    h1 {
      margin: 0;
    }
    
    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 10px;
    }
    
    form {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      padding: 10px
    }
    
    input[type="text"],
    textarea {
      width: 97%;
      padding: 10px;
      border: 5px solid #ccc;
      border-radius: 4px;
      resize: none;
    }
    
    button[type="submit"] {
      background-color: #333;
      color: white;
      padding: 10px 30px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    button[type="submit"]:hover {
      background-color: #444;
    }
    
    article {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      background:grey;
      color: white;
    }
    
    delete-button {
      background-color: red;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
    }


    button.like-button {
  margin-left: 10px;
}

.delete-button {
  background-color: red;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
  margin-left: 10px;
}

.delete-button:hover {
  background-color: darkred;
}




    </style>
</head>
<body>
  <header>
    <h1>Discussion Forum</h1>
  </header>
  <main>
    <form id="post-form">
      <h2>New Post</h2>
      <label for="post-title">Title:</label>
      <input type="text" id="post-title" name="post-title" required>
      <label for="post-content">Content:</label>
      <textarea id="post-content" name="post-content" required></textarea>
      <h2><button type="submit">Post</button></h2>
     </form>
    <section id="post-list">
     
      <h2>Posts</h2>
  </main>

<script>
const postForm = document.getElementById('post-form');
const postList = document.getElementById('post-list');

postForm.addEventListener('submit', event => {
  event.preventDefault();
  const title = event.target.elements['post-title'].value;
  const content = event.target.elements['post-content'].value;
  const post = createPost(title, content);
  postList.appendChild(post);
  postForm.reset();
});

{
  function createPost(title, content) {
  const article = document.createElement('article');
  const titleElement = document.createElement('h2');
  const contentElement = document.createElement('p');
  const replyButton = document.createElement('button');
  const likeButton = document.createElement('button');
  const deleteButton = document.createElement('button');

  titleElement.textContent = title;
  contentElement.textContent = content;
  replyButton.textContent = 'Reply';
  likeButton.textContent = 'Like';
  deleteButton.textContent = 'Delete';
  likeButton.classList.add('like-button');
  deleteButton.classList.add('delete-button');

  replyButton.addEventListener('click', () => {
    const replyForm = document.createElement('form');
    const replyLabel = document.createElement('label');
    const replyInput = document.createElement('textarea');
    const replySubmitButton = document.createElement('button');

    replyLabel.textContent = 'Reply:';
    replyInput.name = 'reply-content';
    replyInput.required = true;
    replySubmitButton.textContent = 'Post Reply';

    replyForm.appendChild(replyLabel);
    replyForm.appendChild(replyInput);
    replyForm.appendChild(replySubmitButton);

    replySubmitButton.addEventListener('click', () => {
      const replyContent = replyInput.value;
      const reply = createReply(replyContent);
      article.appendChild(reply);
      replyForm.remove();
    });

    article.appendChild(replyForm);
  });

  likeButton.addEventListener('click', () => {
    const postId = article.dataset.postId;
    fetch(`/posts/${postId}/like`, { method: 'POST' })
      .then(response => {
        if (response.ok) {
          response.json().then(data => {
            const likeCount = data.likeCount;
            likeButton.textContent = `Liked (${likeCount})`;
          });
        } else {
          // handle error
        }
      });
  });

  deleteButton.addEventListener('click', () => {
    const postId = article.dataset.postId;
    fetch(`/posts/${postId}`, { method: 'DELETE' })
      .then(response => {
        if (response.ok) {
          article.remove();
        } else {
          // handle error
        }
      });
  });

  article.appendChild(titleElement);
  article.appendChild(contentElement);
  article.appendChild(replyButton);
  article.appendChild(likeButton);
  article.appendChild(deleteButton);
  article.dataset.postId = Math.floor(Math.random() * 10000);

  return article;
}

}

function createReply(content) {
  const reply = document.createElement('div');
  const replyContent = document.createElement('p');
  const deleteButton = document.createElement('button');

  replyContent.textContent = content;
  deleteButton.textContent = 'Delete';
  deleteButton.className = 'delete-button';

  deleteButton.addEventListener('click', () => {
    reply.remove();
  });

  reply.appendChild(replyContent);
  reply.appendChild(deleteButton);

  return reply;
}
  


{
const deleteButtons = document.querySelectorAll('.delete-button');
deleteButtons.forEach(button => {
  button.addEventListener('click', () => {
    const postId = button.dataset.postId;
    fetch(`/posts/${postId}`, { method: 'DELETE' })
      .then(response => {
        if (response.ok) {
          // remove the post from the DOM
          const article = button.closest('article');
          article.remove();
        } else {
          // handle error
        }
      });
  });
});
}
</script>
</body>
</html>
